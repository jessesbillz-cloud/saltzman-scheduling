
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Inspection Request â€” Woodland Park MOD</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #F5F3EF;
    --card: #FFFFFF;
    --text: #1A1A1A;
    --text-mid: #4A4540;
    --text-secondary: #6B6560;
    --text-light: #9B9590;
    --accent: #C4451C;
    --accent-hover: #A83915;
    --accent-soft: #FEF0EB;
    --border: #DDD8D0;
    --input-bg: #FAFAF8;
    --input-focus: #FFFCFA;
    --success: #2D7A3A;
    --success-soft: #E8F5EA;
    --warning: #8B6914;
    --warning-bg: #FFF8F0;
    --warning-border: #F0DCC8;
    --shadow: 0 1px 3px rgba(0,0,0,0.04), 0 2px 8px rgba(0,0,0,0.03);
    --radius: 10px;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'DM Sans', -apple-system, sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    -webkit-font-smoothing: antialiased;
  }

  .page {
    max-width: 500px;
    margin: 0 auto;
    padding: 20px 16px 140px;
  }

  /* HEADER */
  .header {
    margin-bottom: 20px;
  }

  .header .project-badge {
    display: inline-block;
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    color: var(--accent);
    background: var(--accent-soft);
    padding: 4px 10px;
    border-radius: 5px;
    margin-bottom: 8px;
  }

  .header h1 {
    font-size: 22px;
    font-weight: 800;
    letter-spacing: -0.5px;
    margin-bottom: 2px;
  }

  .header .subtitle {
    font-size: 13.5px;
    color: var(--text-secondary);
  }

  /* NOTICE */
  .notice {
    background: var(--warning-bg);
    border: 1px solid var(--warning-border);
    border-radius: var(--radius);
    padding: 11px 14px;
    margin-bottom: 20px;
    font-size: 12.5px;
    color: var(--warning);
    line-height: 1.5;
  }

  /* MODE TOGGLE */
  .mode-toggle {
    display: flex;
    background: var(--card);
    border: 1.5px solid var(--border);
    border-radius: var(--radius);
    overflow: hidden;
    margin-bottom: 20px;
  }

  .mode-btn {
    flex: 1;
    padding: 13px;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    font-weight: 600;
    border: none;
    background: transparent;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.15s;
    text-align: center;
  }

  .mode-btn.active {
    background: var(--accent);
    color: white;
  }

  /* FORM SECTIONS */
  .form-section {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 18px;
    margin-bottom: 12px;
    box-shadow: var(--shadow);
  }

  .section-title {
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.7px;
    color: var(--text-light);
    margin-bottom: 14px;
  }

  /* FIELDS */
  .field {
    margin-bottom: 14px;
  }

  .field:last-child { margin-bottom: 0; }

  .field label {
    display: block;
    font-size: 13px;
    font-weight: 600;
    color: var(--text-mid);
    margin-bottom: 6px;
  }

  .field label .req {
    color: var(--accent);
  }

  .field input[type="text"],
  .field input[type="date"],
  .field input[type="time"],
  .field input[type="tel"],
  .field select,
  .field textarea {
    width: 100%;
    padding: 12px;
    font-family: 'DM Sans', sans-serif;
    font-size: 16px;
    color: var(--text);
    background: var(--input-bg);
    border: 1.5px solid var(--border);
    border-radius: 8px;
    transition: all 0.15s;
    -webkit-appearance: none;
    appearance: none;
  }

  .field input:focus,
  .field select:focus,
  .field textarea:focus {
    outline: none;
    border-color: var(--accent);
    background: var(--input-focus);
    box-shadow: 0 0 0 3px rgba(196, 69, 28, 0.06);
  }

  .field textarea {
    min-height: 100px;
    resize: vertical;
    line-height: 1.5;
  }

  .field select {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%236B6560' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 12px center;
    padding-right: 36px;
  }

  .row {
    display: flex;
    gap: 10px;
  }

  .row .field { flex: 1; }

  /* CHIPS */
  .chips {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }

  .chip {
    padding: 9px 15px;
    font-family: 'DM Sans', sans-serif;
    font-size: 13.5px;
    font-weight: 500;
    color: var(--text-secondary);
    background: var(--input-bg);
    border: 1.5px solid var(--border);
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.15s;
    user-select: none;
  }

  .chip:hover { border-color: #C0BAB2; }

  .chip.selected {
    color: var(--accent);
    background: var(--accent-soft);
    border-color: var(--accent);
    font-weight: 600;
  }

  /* YES/NO TOGGLE */
  .yn-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
  }

  .yn-row label {
    flex: 1;
    font-size: 13.5px;
    font-weight: 500;
    color: var(--text-mid);
    line-height: 1.4;
    margin-bottom: 0;
  }

  .yn-group {
    display: flex;
    gap: 6px;
    flex-shrink: 0;
  }

  .yn-btn {
    padding: 8px 18px;
    font-family: 'DM Sans', sans-serif;
    font-size: 13px;
    font-weight: 600;
    border: 1.5px solid var(--border);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.15s;
    background: var(--input-bg);
    color: var(--text-secondary);
  }

  .yn-btn.yes.active {
    background: var(--success-soft);
    border-color: var(--success);
    color: var(--success);
  }

  .yn-btn.no.active {
    background: var(--accent-soft);
    border-color: var(--accent);
    color: var(--accent);
  }

  /* PHOTO UPLOAD */
  .photo-mode { display: none; }
  .photo-mode.active { display: block; }
  .form-mode { display: block; }
  .form-mode.hide { display: none; }

  .upload-zone {
    border: 2px dashed var(--border);
    border-radius: 12px;
    padding: 40px 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.15s;
    background: var(--input-bg);
  }

  .upload-zone:hover {
    border-color: var(--accent);
    background: var(--accent-soft);
  }

  .upload-zone.has-photo {
    padding: 12px;
    border-style: solid;
    border-color: var(--success);
    background: var(--success-soft);
  }

  .upload-zone .upload-icon {
    font-size: 36px;
    margin-bottom: 10px;
  }

  .upload-zone .upload-text {
    font-size: 15px;
    font-weight: 600;
    color: var(--text-mid);
    margin-bottom: 4px;
  }

  .upload-zone .upload-hint {
    font-size: 12.5px;
    color: var(--text-light);
  }

  .upload-zone img {
    max-width: 100%;
    max-height: 300px;
    border-radius: 8px;
    object-fit: contain;
  }

  .upload-zone .photo-actions {
    margin-top: 10px;
    display: flex;
    justify-content: center;
    gap: 10px;
  }

  .photo-retake {
    font-family: 'DM Sans', sans-serif;
    font-size: 13px;
    font-weight: 600;
    color: var(--accent);
    background: none;
    border: none;
    cursor: pointer;
    text-decoration: underline;
  }

  input[type="file"] { display: none; }

  /* CONCRETE FIELDS */
  .concrete-section { display: none; }
  .concrete-section.show { display: block; }

  /* SUBMIT */
  .submit-bar {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    padding: 14px 16px;
    padding-bottom: max(14px, env(safe-area-inset-bottom));
    background: rgba(245, 243, 239, 0.95);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-top: 1px solid var(--border);
    z-index: 50;
  }

  .submit-btn {
    width: 100%;
    max-width: 500px;
    margin: 0 auto;
    display: block;
    padding: 16px;
    font-family: 'DM Sans', sans-serif;
    font-size: 16px;
    font-weight: 700;
    color: white;
    background: var(--accent);
    border: none;
    border-radius: var(--radius);
    cursor: pointer;
    transition: all 0.15s;
  }

  .submit-btn:hover { background: var(--accent-hover); }
  .submit-btn:active { transform: scale(0.985); }

  /* SUCCESS */
  .success-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: var(--bg);
    z-index: 100;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 24px;
  }

  .success-overlay.active { display: flex; }

  .success-check {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background: var(--success-soft);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 18px;
  }

  .success-check svg { width: 32px; height: 32px; color: var(--success); }

  .success-overlay h2 {
    font-size: 22px;
    font-weight: 800;
    margin-bottom: 8px;
  }

  .success-overlay p {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.5;
    max-width: 280px;
    margin-bottom: 24px;
  }

  .success-overlay .ir-num {
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    font-weight: 700;
    color: var(--accent);
    background: var(--accent-soft);
    padding: 8px 16px;
    border-radius: 6px;
    margin-bottom: 24px;
  }

  .another-btn {
    padding: 13px 28px;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    font-weight: 600;
    color: var(--accent);
    background: none;
    border: 1.5px solid var(--accent);
    border-radius: var(--radius);
    cursor: pointer;
  }

  .another-btn:hover { background: var(--accent-soft); }
</style>
</head>
<body>

<div class="page">

  <!-- HEADER -->
  <div class="header">
    <div class="project-badge">Lusardi â€” Woodland Park MOD</div>
    <h1>Inspection Request</h1>
    <div class="subtitle">San Marcos Unified School District</div>
  </div>

  <!-- NOTICE -->
  <div class="notice">
    Submit 24 hours in advance (48 hours for soil tech or specialty inspector). You must be present with the inspector at the scheduled time.
  </div>

  <!-- MODE TOGGLE -->
  <div class="mode-toggle">
    <button class="mode-btn active" onclick="setMode('form')">Fill Out Form</button>
    <button class="mode-btn" onclick="setMode('photo')">Upload Photo</button>
  </div>

  <!-- ========== PHOTO UPLOAD MODE ========== -->
  <div class="photo-mode" id="photoMode">
    <div class="form-section">
      <div class="section-title">Upload Paper Form</div>
      <div class="upload-zone" id="uploadZone" onclick="document.getElementById('photoInput').click()">
        <div id="uploadPlaceholder">
          <div class="upload-icon">ðŸ“·</div>
          <div class="upload-text">Tap to take photo or upload</div>
          <div class="upload-hint">Snap a picture of the handwritten form</div>
        </div>
        <div id="uploadPreview" style="display:none;">
          <img id="previewImg" src="" alt="Form photo">
          <div class="photo-actions">
            <button class="photo-retake" onclick="event.stopPropagation(); retakePhoto()">Retake</button>
          </div>
        </div>
      </div>
      <input type="file" id="photoInput" accept="image/*" capture="environment" onchange="handlePhoto(this)">
    </div>

    <!-- Quick fields for photo mode -->
    <div class="form-section">
      <div class="section-title">Quick Details</div>
      <div class="row">
        <div class="field">
          <label>Inspection Date <span class="req">*</span></label>
          <input type="date" id="photoDate">
        </div>
        <div class="field">
          <label>Time <span class="req">*</span></label>
          <input type="time" id="photoTime">
        </div>
      </div>
      <div class="field">
        <label>Inspection Type <span class="req">*</span></label>
        <select id="photoType">
          <option value="">Select type</option>
          <option>Concrete</option>
          <option>Grout</option>
          <option>Rebar</option>
          <option>Masonry</option>
          <option>Structural Steel</option>
          <option>Welding</option>
          <option>Material ID</option>
          <option>Bolting</option>
          <option>Soil / Compaction</option>
          <option>Other</option>
        </select>
      </div>
      <div class="field">
        <label>Subcontractor <span class="req">*</span></label>
        <input type="text" id="photoSub" placeholder="Sub company name">
      </div>
    </div>
  </div>

  <!-- ========== DIGITAL FORM MODE ========== -->
  <div class="form-mode" id="formMode">

    <!-- GC & Sub Info -->
    <div class="form-section">
      <div class="section-title">Request Info</div>
      <div class="row">
        <div class="field">
          <label>Subcontractor <span class="req">*</span></label>
          <input type="text" id="subName" placeholder="Company name">
        </div>
        <div class="field">
          <label>Contact Phone</label>
          <input type="tel" id="subPhone" placeholder="(619) 555-1234">
        </div>
      </div>
    </div>

    <!-- Scheduling -->
    <div class="form-section">
      <div class="section-title">Scheduling</div>
      <div class="row">
        <div class="field">
          <label>Date of Inspection <span class="req">*</span></label>
          <input type="date" id="inspDate">
        </div>
        <div class="field">
          <label>Time <span class="req">*</span></label>
          <input type="time" id="inspTime">
        </div>
      </div>
      <div class="field">
        <label>Duration</label>
        <select id="inspDuration">
          <option value="">Select</option>
          <option value="2hr">2 Hours</option>
          <option value="half">Half Day</option>
          <option value="full">Full Day</option>
        </select>
      </div>
    </div>

    <!-- Inspection Type -->
    <div class="form-section">
      <div class="section-title">Type of Special Inspection</div>
      <div class="chips" id="typeChips">
        <div class="chip" onclick="toggleChip(this)">Concrete</div>
        <div class="chip" onclick="toggleChip(this)">Grout</div>
        <div class="chip" onclick="toggleChip(this)">Rebar</div>
        <div class="chip" onclick="toggleChip(this)">Masonry</div>
        <div class="chip" onclick="toggleChip(this)">Structural Steel</div>
        <div class="chip" onclick="toggleChip(this)">Welding</div>
        <div class="chip" onclick="toggleChip(this)">Material ID</div>
        <div class="chip" onclick="toggleChip(this)">Bolting</div>
        <div class="chip" onclick="toggleChip(this)">Soil / Compaction</div>
        <div class="chip" onclick="toggleChip(this)">Other</div>
      </div>
    </div>

    <!-- Concrete/Grout Details (conditional) -->
    <div class="form-section concrete-section" id="concreteSection">
      <div class="section-title">Concrete / Grout Details</div>
      <div class="field">
        <label>Mix Design #</label>
        <input type="text" id="mixDesign" placeholder="e.g. MIX #1614585">
      </div>
      <div class="row">
        <div class="field">
          <label>Total Yards</label>
          <input type="text" id="totalYards" placeholder="e.g. 40+">
        </div>
        <div class="field">
          <label>Plant Name</label>
          <input type="text" id="plantName" placeholder="Concrete plant">
        </div>
      </div>
      <div class="field">
        <label>Plant Address</label>
        <input type="text" id="plantAddress" placeholder="Full address with phone">
      </div>
    </div>

    <!-- Location & Description -->
    <div class="form-section">
      <div class="section-title">Item &amp; Location</div>
      <div class="field">
        <label>Specific Location &amp; Work Description <span class="req">*</span></label>
        <textarea id="locationDetail" placeholder="Grid lines, building name, room numbers, etc. For concrete/grout include mix design, yards, and plant address."></textarea>
      </div>
    </div>

    <!-- GC Verification -->
    <div class="form-section">
      <div class="section-title">GC Verification</div>
      <div class="yn-row">
        <label>GC has verified the work complies with plans, specs, and codes</label>
        <div class="yn-group">
          <button type="button" class="yn-btn yes" onclick="toggleYN(this, 'yes')">Yes</button>
          <button type="button" class="yn-btn no" onclick="toggleYN(this, 'no')">No</button>
        </div>
      </div>
      <div class="field" style="margin-top: 14px;">
        <label>Superintendent Name</label>
        <input type="text" id="superName" placeholder="GC superintendent">
      </div>
    </div>

  </div><!-- end form-mode -->

</div><!-- end page -->

<!-- SUBMIT -->
<div class="submit-bar">
  <button class="submit-btn" onclick="submitForm()">Submit Inspection Request</button>
</div>

<!-- SUCCESS -->
<div class="success-overlay" id="successOverlay">
  <div class="success-check">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20 6L9 17l-5-5"/></svg>
  </div>
  <h2>Request Submitted</h2>
  <p>Your inspection request has been sent to Jesse Saltzman and will appear on his schedule.</p>
  <div class="ir-num" id="irNum">IR #0092</div>
  <button class="another-btn" onclick="resetAll()">Submit Another</button>
</div>

<script>
  const SUPABASE_URL = 'https://esxeusjjeuyhwwrtwpcv.supabase.co';
  const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVzeGV1c2pqZXV5aHd3cnR3cGN2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA3Mzg0MDYsImV4cCI6MjA4NjMxNDQwNn0.dBEhvcxnscwk1gmb3FGYexmLlrzbd60NFzkt4771IvE';
  const SUBMIT_URL = `${SUPABASE_URL}/functions/v1/submit-inspection`;

  let mode = 'form';
  let gcVerified = null;
  let photoFile = null;
  let selectedTypes = [];
  let isSubmitting = false;

  // MODE TOGGLE
  function setMode(m) {
    mode = m;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');
    
    document.getElementById('photoMode').classList.toggle('active', m === 'photo');
    document.getElementById('formMode').classList.toggle('hide', m === 'photo');
  }

  // CHIPS
  function toggleChip(chip) {
    chip.classList.toggle('selected');
    selectedTypes = Array.from(document.querySelectorAll('#typeChips .chip.selected')).map(c => c.textContent);
    
    const showConcrete = selectedTypes.some(t => t === 'Concrete' || t === 'Grout');
    document.getElementById('concreteSection').classList.toggle('show', showConcrete);
  }

  // YES/NO
  function toggleYN(btn, val) {
    const group = btn.closest('.yn-group');
    group.querySelectorAll('.yn-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    gcVerified = val;
  }

  // PHOTO
  function handlePhoto(input) {
    if (input.files && input.files[0]) {
      photoFile = input.files[0];
      const reader = new FileReader();
      reader.onload = function(e) {
        document.getElementById('previewImg').src = e.target.result;
        document.getElementById('uploadPlaceholder').style.display = 'none';
        document.getElementById('uploadPreview').style.display = 'block';
        document.getElementById('uploadZone').classList.add('has-photo');
      };
      reader.readAsDataURL(input.files[0]);
    }
  }

  function retakePhoto() {
    photoFile = null;
    document.getElementById('photoInput').value = '';
    document.getElementById('uploadPlaceholder').style.display = 'block';
    document.getElementById('uploadPreview').style.display = 'none';
    document.getElementById('uploadZone').classList.remove('has-photo');
  }

  // SUBMIT
  async function submitForm() {
    if (isSubmitting) return;

    const submitBtn = document.querySelector('.submit-btn');

    if (mode === 'form') {
      const sub = document.getElementById('subName').value.trim();
      const date = document.getElementById('inspDate').value;
      const time = document.getElementById('inspTime').value;
      const location = document.getElementById('locationDetail').value.trim();
      
      if (!sub || !date || !time || !location) {
        alert('Please fill in all required fields.');
        return;
      }

      isSubmitting = true;
      submitBtn.textContent = 'Submitting...';
      submitBtn.disabled = true;

      try {
        const response = await fetch(SUBMIT_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
            'apikey': SUPABASE_ANON_KEY
          },
          body: JSON.stringify({
            mode: 'form',
            project: 'WPMS',
            gc: 'Lusardi',
            subcontractor: sub,
            sub_phone: document.getElementById('subPhone').value,
            inspection_date: date,
            inspection_time: time,
            duration: document.getElementById('inspDuration').value,
            inspection_types: selectedTypes,
            mix_design: document.getElementById('mixDesign').value || null,
            total_yards: document.getElementById('totalYards').value || null,
            plant_name: document.getElementById('plantName').value || null,
            plant_address: document.getElementById('plantAddress').value || null,
            location_detail: location,
            gc_verified: gcVerified,
            superintendent_name: document.getElementById('superName').value || null
          })
        });

        const result = await response.json();

        if (result.success || result.ir_number) {
          document.getElementById('irNum').textContent = `IR #${String(result.ir_number).padStart(4, '0')}`;
          document.getElementById('successOverlay').classList.add('active');
        } else {
          alert('Error submitting request: ' + (result.error || 'Unknown error. Please try again.'));
        }
      } catch (err) {
        console.error('Submit error:', err);
        alert('Could not connect to server. Check your internet connection and try again.');
      }

      isSubmitting = false;
      submitBtn.textContent = 'Submit Inspection Request';
      submitBtn.disabled = false;

    } else {
      // Photo mode
      const date = document.getElementById('photoDate').value;
      const time = document.getElementById('photoTime').value;
      const type = document.getElementById('photoType').value;
      const sub = document.getElementById('photoSub').value.trim();

      if (!photoFile || !date || !time || !type || !sub) {
        alert('Please upload a photo and fill in all required fields.');
        return;
      }

      isSubmitting = true;
      submitBtn.textContent = 'Uploading...';
      submitBtn.disabled = true;

      try {
        const formData = new FormData();
        formData.append('photo', photoFile);
        formData.append('mode', 'photo');
        formData.append('project', 'WPMS');
        formData.append('gc', 'Lusardi');
        formData.append('inspection_date', date);
        formData.append('inspection_time', time);
        formData.append('inspection_types', JSON.stringify([type]));
        formData.append('subcontractor', sub);

        const response = await fetch(SUBMIT_URL, {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
            'apikey': SUPABASE_ANON_KEY
          },
          body: formData
        });

        const result = await response.json();

        if (result.success || result.ir_number) {
          document.getElementById('irNum').textContent = `IR #${String(result.ir_number).padStart(4, '0')}`;
          document.getElementById('successOverlay').classList.add('active');
        } else {
          alert('Error submitting request: ' + (result.error || 'Unknown error. Please try again.'));
        }
      } catch (err) {
        console.error('Submit error:', err);
        alert('Could not connect to server. Check your internet connection and try again.');
      }

      isSubmitting = false;
      submitBtn.textContent = 'Submit Inspection Request';
      submitBtn.disabled = false;
    }
  }

  // RESET
  function resetAll() {
    document.getElementById('successOverlay').classList.remove('active');
    
    document.querySelectorAll('input[type="text"], input[type="tel"], textarea').forEach(i => i.value = '');
    document.querySelectorAll('input[type="date"], input[type="time"]').forEach(i => i.value = '');
    document.querySelectorAll('select').forEach(s => s.selectedIndex = 0);
    document.querySelectorAll('.chip').forEach(c => c.classList.remove('selected'));
    document.querySelectorAll('.yn-btn').forEach(b => b.classList.remove('active'));
    document.getElementById('concreteSection').classList.remove('show');
    
    selectedTypes = [];
    gcVerified = null;
    retakePhoto();
    
    window.scrollTo(0, 0);
  }

  // Set min date to today
  const today = new Date().toISOString().split('T')[0];
  document.querySelectorAll('input[type="date"]').forEach(d => d.setAttribute('min', today));
</script>

</body>
</html>
